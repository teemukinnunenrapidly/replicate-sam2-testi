"use strict";(()=>{var e={};e.id=6,e.ids=[6],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8893:e=>{e.exports=require("buffer")},7702:e=>{e.exports=require("events")},6162:e=>{e.exports=require("stream")},2370:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>_,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var s={};r.r(s),r.d(s,{POST:()=>c});var o=r(9303),i=r(8716),n=r(670),a=r(7070),p=r(4060);let u=new(r.n(p)())({auth:process.env.REPLICATE_API_TOKEN});async function c(e){try{if(!process.env.REPLICATE_API_TOKEN)return a.NextResponse.json({detail:"REPLICATE_API_TOKEN environment variable is not set"},{status:500});let t=await e.json();if(!t.imageData)return a.NextResponse.json({detail:"Image data is required"},{status:400});console.log("Creating SAM-2 prediction with:",{promptType:t.promptType,pointsPerSide:t.pointsPerSide,predIouThresh:t.predIouThresh,stabilityScoreThresh:t.stabilityScoreThresh});let r={version:"meta/sam-2:fe97b453a6455861e3bac769b441ca1f1086110da7466dbb65cf1eecfd60dc83",input:{image:t.imageData,prompt_type:t.promptType||"text",points_per_side:t.pointsPerSide||32,pred_iou_thresh:t.predIouThresh||.88,stability_score_thresh:t.stabilityScoreThresh||.95}};if(process.env.VERCEL_URL){let e=`https://${process.env.VERCEL_URL}/api/webhooks`;r.webhook=e,r.webhook_events_filter=["completed"]}let s=await u.predictions.create(r);return console.log("SAM-2 prediction created:",s),a.NextResponse.json(s,{status:201})}catch(t){console.error("Prediction creation error:",t);let e=t instanceof Error?t.message:"Unknown error occurred";return a.NextResponse.json({detail:e},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/predictions/route",pathname:"/api/predictions",filename:"route",bundlePath:"app/api/predictions/route"},resolvedPagePath:"/Users/teemukinnunen/Rapidly/replicate-testi/app/api/predictions/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:h,serverHooks:m}=d,v="/api/predictions/route";function _(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[789,60],()=>r(2370));module.exports=s})();